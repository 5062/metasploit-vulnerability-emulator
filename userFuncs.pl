$kloxo_sqli_target = "YWJjMTIz";
sub kloxo_sqli {
	#print "$dataBuf\n";
	if ($dataBuf !~ /from%20client%20limit%201%29%2c(\d+)%2c1%29%29%3d(\d+)%/) {
		print "no match\n";
		return "";
	}
	my $pos  = $1;
	my $c    = pack("C", $2);
	#printf "$pos|$c\n";
	my $r = 0;
	if ($pos == 1) {
		$r = ($c eq "_")? 1 : 0;
	} elsif ($pos < 8) {
		$r = 1;
	} elsif ($pos == 16) { #16 = 7 + length(kloxo_sqli_target);
		$r = 1;
	} elsif (substr($kloxo_sqli_target, $pos-8, 1) eq $c) {
		$r = 1;
	}
	if ($r) {
		return "HTTP/1.1 200\r\nContent-Length: 0\r\n\r\n";
	} else {
		return "HTTP/1.1 200\r\nContent-Length: 18\r\n\r\n_error_login_error";
	}
}

1;
